var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function i(t){t.forEach(n)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}const l="undefined"!=typeof window;let a=l?()=>window.performance.now():()=>Date.now(),c=l?t=>requestAnimationFrame(t):t;const u=new Set;function d(t){u.forEach((e=>{e.c(t)||(u.delete(e),e.f())})),0!==u.size&&c(d)}function h(t){let e;return 0===u.size&&c(d),{promise:new Promise((n=>{u.add(e={c:t,f:n})})),abort(){u.delete(e)}}}let p=!1;function f(t,e,n,o){for(;t<e;){const i=t+(e-t>>1);n(i)<=o?t=i+1:e=i}return t}function m(t,e){p?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),o=new Int32Array(e.length);n[0]=-1;let i=0;for(let t=0;t<e.length;t++){const r=f(1,i+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;o[t]=n[r]+1;const s=r+1;n[s]=t,i=Math.max(s,i)}const r=[],s=[];let l=e.length-1;for(let t=n[i]+1;0!=t;t=o[t-1]){for(r.push(e[t-1]);l>=t;l--)s.push(e[l]);l--}for(;l>=0;l--)s.push(e[l]);r.reverse(),s.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<s.length;e++){for(;n<r.length&&s[e].claim_order>=r[n].claim_order;)n++;const o=n<r.length?r[n]:null;t.insertBefore(s[e],o)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function g(t,e,n){p&&!n?m(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function v(t){t.parentNode.removeChild(t)}function y(t){return document.createElement(t)}function x(t){return document.createTextNode(t)}function _(){return x(" ")}function w(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}const k=new Set;let I,C=0;function E(t,e,n,o,i,r,s,l=0){const a=16.666/o;let c="{\n";for(let t=0;t<=1;t+=a){const o=e+(n-e)*r(t);c+=100*t+`%{${s(o,1-o)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`,h=t.ownerDocument;k.add(h);const p=h.__svelte_stylesheet||(h.__svelte_stylesheet=h.head.appendChild(y("style")).sheet),f=h.__svelte_rules||(h.__svelte_rules={});f[d]||(f[d]=!0,p.insertRule(`@keyframes ${d} ${u}`,p.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${d} ${o}ms linear ${i}ms 1 both`,C+=1,d}function L(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-o.length;i&&(t.style.animation=o.join(", "),C-=i,C||c((()=>{C||(k.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),k.clear())})))}function R(t){I=t}function S(){if(!I)throw new Error("Function called outside component initialization");return I}function O(t){S().$$.on_mount.push(t)}const P=[],T=[],D=[],j=[],F=Promise.resolve();let N=!1;function A(t){D.push(t)}function W(t){j.push(t)}let M=!1;const z=new Set;function U(){if(!M){M=!0;do{for(let t=0;t<P.length;t+=1){const e=P[t];R(e),B(e.$$)}for(R(null),P.length=0;T.length;)T.pop()();for(let t=0;t<D.length;t+=1){const e=D[t];z.has(e)||(z.add(e),e())}D.length=0}while(P.length);for(;j.length;)j.pop()();N=!1,M=!1,z.clear()}}function B(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}let X;function q(){return X||(X=Promise.resolve(),X.then((()=>{X=null}))),X}function Y(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const G=new Set;let H;function J(t,e){t&&t.i&&(G.delete(t),t.i(e))}function K(t,e,n,o){if(t&&t.o){if(G.has(t))return;G.add(t),H.c.push((()=>{G.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}const Q={duration:0};function V(n,o,i){let s,l,c=o(n,i),u=!1,d=0;function p(){s&&L(n,s)}function f(){const{delay:o=0,duration:i=300,easing:r=e,tick:f=t,css:m}=c||Q;m&&(s=E(n,0,1,i,o,r,m,d++)),f(0,1);const g=a()+o,v=g+i;l&&l.abort(),u=!0,A((()=>Y(n,!0,"start"))),l=h((t=>{if(u){if(t>=v)return f(1,0),Y(n,!0,"end"),p(),u=!1;if(t>=g){const e=r((t-g)/i);f(e,1-e)}}return u}))}let m=!1;return{start(){m||(L(n),r(c)?(c=c(),q().then(f)):f())},invalidate(){m=!1},end(){u&&(p(),u=!1)}}}function Z(n,o,s){let l,c=o(n,s),u=!0;const d=H;function p(){const{delay:o=0,duration:r=300,easing:s=e,tick:p=t,css:f}=c||Q;f&&(l=E(n,1,0,r,o,s,f));const m=a()+o,g=m+r;A((()=>Y(n,!1,"start"))),h((t=>{if(u){if(t>=g)return p(0,1),Y(n,!1,"end"),--d.r||i(d.c),!1;if(t>=m){const e=s((t-m)/r);p(1-e,e)}}return u}))}return d.r+=1,r(c)?q().then((()=>{c=c(),p()})):p(),{end(t){t&&c.tick&&c.tick(1,0),u&&(l&&L(n,l),u=!1)}}}function tt(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function et(t){t&&t.c()}function nt(t,e,o,s){const{fragment:l,on_mount:a,on_destroy:c,after_update:u}=t.$$;l&&l.m(e,o),s||A((()=>{const e=a.map(n).filter(r);c?c.push(...e):i(e),t.$$.on_mount=[]})),u.forEach(A)}function ot(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function it(t,e){-1===t.$$.dirty[0]&&(P.push(t),N||(N=!0,F.then(U)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function rt(e,n,r,s,l,a,c=[-1]){const u=I;R(e);const d=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:n.context||[]),callbacks:o(),dirty:c,skip_bound:!1};let h=!1;if(d.ctx=r?r(e,n.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return d.ctx&&l(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),h&&it(e,t)),n})):[],d.update(),h=!0,i(d.before_update),d.fragment=!!s&&s(d.ctx),n.target){if(n.hydrate){p=!0;const t=function(t){return Array.from(t.childNodes)}(n.target);d.fragment&&d.fragment.l(t),t.forEach(v)}else d.fragment&&d.fragment.c();n.intro&&J(e.$$.fragment),nt(e,n.target,n.anchor,n.customElement),p=!1,U()}R(u)}class st{$destroy(){ot(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function lt(e){let n,o,r,s,l,a,c,u,d,h,p,f,x,$,k,I;return{c(){var t,e,i;n=y("div"),o=y("div"),o.innerHTML='<h2 class="mdl-card__title-text">1. Crop</h2>',r=_(),s=y("div"),l=y("canvas"),a=_(),c=y("div"),c.textContent="INSTRUCTIONS HERE",u=_(),d=y("div"),h=y("button"),h.textContent="Choose Image",p=_(),f=y("button"),f.textContent="Crop Selection",x=_(),$=y("input"),b(o,"class","mdl-card__title svelte-1k9lwuc"),b(l,"id","cropCanvas"),b(l,"width",at),b(l,"height",at),b(l,"class","svelte-1k9lwuc"),b(c,"class","mdl-card__supporting-text"),b(h,"class","mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored"),b(h,"id","import"),b(f,"class","mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored"),b(f,"role","button"),b(f,"id","crop"),t="display",e="none",$.style.setProperty(t,e,i?"important":""),b($,"type","file"),b($,"accept",".jpg, .jpeg, .png"),b(d,"class","mdl-card__actions mdl-card--border"),b(n,"class","image-import-container mdl-card mdl-shadow--2dp svelte-1k9lwuc")},m(t,i){g(t,n,i),m(n,o),m(n,r),m(n,s),m(s,l),m(n,a),m(n,c),m(n,u),m(n,d),m(d,h),m(d,p),m(d,f),m(d,x),m(d,$),e[14]($),k||(I=[w(l,"contextmenu",e[7]),w(l,"wheel",e[3]),w(l,"mousedown",e[4]),w(l,"mousemove",e[2]),w(l,"mouseup",e[5]),w(l,"mouseout",e[6]),w(h,"click",e[12]),w(f,"click",e[13]),w($,"change",e[8])],k=!0)},p:t,i:t,o:t,d(t){t&&v(n),e[14](null),k=!1,i(I)}}}const at=400;function ct(t,e,n){let o,i,r,s,l,a,c,u,d,h,p,f,{croppedImage:m}=e,{step:g}=e,{nextStep:v}=e,y=1,x={x:0,y:0},_={...x},w=!1,b=[];function $(){const t=i.getBoundingClientRect();u=t.left,d=t.top}function k(){const t=i.width/2,e=i.height/2;r.save(),r.beginPath(),r.translate(t-45,e-55),r.scale(45,55),r.arc(1,1,1,0,2*Math.PI,!1),r.restore(),r.stroke()}function I(t){r.fillStyle="rgb(63,81,181)",r.beginPath(),console.log(t.x,t.y),r.arc(t.x,t.y,4,0,2*Math.PI),r.fill()}function C(t,e){console.log("drawPath",t,e),r.lineWidth=1.5,r.beginPath(),r.moveTo(t.x,t.y),r.lineTo(e.x,e.y),r.stroke()}function E(t,e=p,n=f,o=!1,a=!0){o&&(l=new Image),l.src=t,p=e,f=n,l.onload=()=>{console.log("loaded2"),r.clearRect(0,0,i.width,i.height),r.drawImage(s,x.x,x.y,e,n),a&&k(),$()}}function L(t){y=t<.1?.1:t>5?5:t;const[e,n]=[i.width,i.height];E(i.toDataURL("image/jpeg"),e*t,n*t)}function R(){const t=new Image,e=document.createElement("canvas");e.width=i.width,e.height=i.height;const o=e.getContext("2d");console.log(s,x.x,x.y,p,f),i.getContext("2d").drawImage(s,x.x,x.y,p,f),r.globalCompositeOperation="destination-out",o.drawImage(i,0,0),t.src=i.toDataURL("image/jpeg"),o.clearRect(0,0,i.width,i.height),o.beginPath(),o.globalCompositeOperation="destination-over";let l=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,c=0,u=0;for(let t=0;t<b.length;t++){const{x:e,y:n}=b[t];e<l&&(l=e),n<a&&(a=n),e>c&&(c=e),n>u&&(u=n),0==t?o.moveTo(e,n):o.lineTo(e,n)}b=[],t.onload=()=>{let i=o.createPattern(t,"repeat");o.fillStyle=i,o.fill(),function(t,e,n,o,i,r){console.log(e,n,o,i);const s=new Image,l=document.createElement("canvas");s.src=t,s.onload=()=>{l.width=o,l.height=i;const t=l.getContext("2d");t.drawImage(s,-e,-n),t.putImageData(function(t,e){for(var n=t.data,o=128*(1-(e=e/100+1)),i=0;i<n.length;i+=4)n[i]=n[i]*e+o,n[i+1]=n[i+1]*e+o,n[i+2]=n[i+2]*e+o;return t}(t.getImageData(0,0,l.width,l.height),-10),0,0);const a=new Image;a.src=l.toDataURL("image/png"),a.onload=()=>r(a)}}(e.toDataURL("image/png"),l,a,c-l,u-a,(t=>{n(11,v=2),n(10,g=2),n(0,m=t)}))}}O((()=>{i=document.getElementById("cropCanvas"),r=i.getContext("2d"),k(),$(),document.addEventListener("scroll",$),window.addEventListener("resize",$)}));return t.$$set=t=>{"croppedImage"in t&&n(0,m=t.croppedImage),"step"in t&&n(10,g=t.step),"nextStep"in t&&n(11,v=t.nextStep)},[m,o,function(t){a=parseInt(t.clientX-u),c=parseInt(t.clientY-d),w&&(r.clearRect(0,0,i.width,i.height),x={x:_.x-(h.x-a),y:_.y-(h.y-c)},r.drawImage(s,x.x,x.y,p,f),k())},function(t){var e;t.preventDefault(),((e=t).wheelDelta?e.wheelDelta>0:e.deltaY<0)?L(y+(y>=1?.3:.1)):L(y-(y>1?.3:.1))},function(t){a=parseInt(t.clientX-u),c=parseInt(t.clientY-d),console.log("current mouse pos",a,c),console.log("current image pos",x.x,x.y),0===t.button&&a>x.x&&c>x.y&&a<x.x+p&&c<x.y+f&&(h={x:a,y:c},_={...x},console.log("orig pos",h),w=!0)},function(t){a=parseInt(t.clientX-u),c=parseInt(t.clientY-d),w=!1,1===t.button&&l&&E(i.toDataURL("image/jpeg"))},function(t){a=parseInt(t.clientX-u),c=parseInt(t.clientY-d),w=!1},function(t){t.preventDefault(),console.log("adding pointer");const e={x:t.offsetX,y:t.offsetY};b.push(e),function(){console.log(b);for(let t=1;t<b.length;t++){C(b[t-1],b[t])}console.log("drew paths");for(let t=0;t<b.length;t++){I(b[t])}console.log("drew points")}()},function(t){let e=t.target.files[0],n=new FileReader;n.readAsDataURL(e),n.onload=t=>{s=new Image,s.src=t.target.result,s.onload=()=>{const t=document.createElement("canvas"),e=s.height/s.width,n=at,o=e*n;t.width=n,t.height=o,i.width=n,i.height=o,t.getContext("2d").drawImage(s,0,0,n,o),E(t.toDataURL("image/jpeg"),i.width,i.height,!0),$()}}},R,g,v,()=>o.click(),()=>{n(0,m=R())},function(t){T[t?"unshift":"push"]((()=>{o=t,n(1,o)}))}]}class ut extends st{constructor(t){super(),rt(this,t,ct,lt,s,{croppedImage:0,step:10,nextStep:11},[-1,-1])}}var dt=Object.freeze({__proto__:null,partyParrot:{name:"Party Parrot",playSpeed:70,positions:[{x:36.5,y:10.5},{x:26.5,y:5.5},{x:9.5,y:10.5},{x:2.5,y:15.5},{x:-4.5,y:20.5},{x:4.5,y:16.5},{x:16.5,y:20.5},{x:28.5,y:22.5},{x:36.5,y:17.5},{x:42.5,y:15.5}]},partyBlob:{name:"Party Blob",playSpeed:25,positions:[{x:30.5,y:-36.5},{x:29.5,y:-32.5},{x:29.5,y:-24.5},{x:30.5,y:-20.5},{x:30.5,y:-14.5},{x:31.5,y:-6.5},{x:32.5,y:6.5},{x:34.5,y:16.5},{x:29.5,y:8.5},{x:28.5,y:-2.5},{x:30,y:-11},{x:27,y:-17},{x:27,y:-29},{x:27,y:-33},{x:27,y:-38},{x:25,y:-45},{x:27,y:-46},{x:30,y:-50},{x:29,y:-49},{x:27,y:-43},{x:27,y:-36},{x:26,y:-21},{x:25,y:-7},{x:25,y:-6},{x:23,y:8},{x:23,y:18},{x:21,y:17},{x:20,y:8},{x:23,y:-2},{x:27,y:-11},{x:27,y:-23},{x:29,y:-28},{x:31,y:-34},{x:28,y:-41},{x:30,y:-43},{x:29,y:-43}]}});function ht(e){let n,o,i,s;return{c(){n=y("button"),o=x(e[1]),b(n,"class","mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored"),b(n,"role","button"),b(n,"id",e[2])},m(t,l){g(t,n,l),m(n,o),i||(s=w(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),i=!0)},p(t,[i]){e=t,2&i&&$(o,e[1]),4&i&&b(n,"id",e[2])},i:t,o:t,d(t){t&&v(n),i=!1,s()}}}function pt(t,e,n){let{onClick:o}=e,{buttonText:i}=e,{id:r}=e;return t.$$set=t=>{"onClick"in t&&n(0,o=t.onClick),"buttonText"in t&&n(1,i=t.buttonText),"id"in t&&n(2,r=t.id)},[o,i,r]}class ft extends st{constructor(t){super(),rt(this,t,pt,ht,s,{onClick:0,buttonText:1,id:2})}}function mt(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function gt(t){let e,n,o,i,r,s,l,a,c,u,d,h,p,f,$,k,I,C=t[6][1].name+"";return{c(){e=y("li"),n=y("span"),o=y("img"),s=_(),l=x(C),a=_(),c=y("span"),u=y("label"),d=y("input"),$=_(),b(o,"class","gif-preview-image svelte-pfxx9r"),o.src!==(i=`${t[6][0]}/0.gif`)&&b(o,"src",i),b(o,"alt",r=`${t[6][0]}-preview`),b(n,"class","mdl-list__item-primary-content"),b(d,"type","radio"),b(d,"id",h="gif-option-"+t[8]),b(d,"class","mdl-radio__button"),b(d,"name","gifselect"),d.__value=p=t[6][0],d.value=d.__value,t[5][0].push(d),b(u,"class","demo-list-radio mdl-radio mdl-js-radio mdl-js-ripple-effect"),b(u,"for",f="gif-option-"+t[8]),b(c,"class","mdl-list__item-secondary-action"),b(e,"class","mdl-list__item")},m(i,r){g(i,e,r),m(e,n),m(n,o),m(n,s),m(n,l),m(e,a),m(e,c),m(c,u),m(u,d),d.checked=d.__value===t[0],m(e,$),k||(I=w(d,"change",t[4]),k=!0)},p(t,e){1&e&&(d.checked=d.__value===t[0])},d(n){n&&v(e),t[5][0].splice(t[5][0].indexOf(d),1),k=!1,I()}}}function vt(t){let e,n,o,i,r,s,l,a,c=t[1],u=[];for(let e=0;e<c.length;e+=1)u[e]=gt(mt(t,c,e));return l=new ft({props:{id:"continue",onClick:t[2],buttonText:"Continue"}}),{c(){e=y("div"),n=y("div"),n.innerHTML='<h2 class="mdl-card__title-text">2. Pick</h2>',o=_(),i=y("ul");for(let t=0;t<u.length;t+=1)u[t].c();r=_(),s=y("div"),et(l.$$.fragment),b(n,"class","mdl-card__title svelte-pfxx9r"),b(i,"class","mdl-list"),b(s,"class","mdl-card__actions mdl-card--border"),b(e,"class","gif-list-container mdl-card mdl-shadow--2dp svelte-pfxx9r")},m(t,c){g(t,e,c),m(e,n),m(e,o),m(e,i);for(let t=0;t<u.length;t+=1)u[t].m(i,null);m(e,r),m(e,s),nt(l,s,null),a=!0},p(t,[e]){if(3&e){let n;for(c=t[1],n=0;n<c.length;n+=1){const o=mt(t,c,n);u[n]?u[n].p(o,e):(u[n]=gt(o),u[n].c(),u[n].m(i,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=c.length}},i(t){a||(J(l.$$.fragment,t),a=!0)},o(t){K(l.$$.fragment,t),a=!1},d(t){t&&v(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(u,t),ot(l)}}}function yt(t,e,n){const o=Object.entries(dt);let{selectedOption:i="partyParrot"}=e,{step:r}=e;return t.$$set=t=>{"selectedOption"in t&&n(0,i=t.selectedOption),"step"in t&&n(3,r=t.step)},[i,o,function(){n(3,r=2)},r,function(){i=this.__value,n(0,i)},[[]]]}class xt extends st{constructor(t){super(),rt(this,t,yt,vt,s,{selectedOption:0,step:3})}}function _t(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}var wt,bt=(function(t,e){t.exports=function t(e,n,o){function i(s,l){if(!n[s]){if(!e[s]){if(!l&&_t)return _t(s);if(r)return r(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var c=n[s]={exports:{}};e[s][0].call(c.exports,(function(t){var n=e[s][1][t];return i(n||t)}),c,c.exports,t,e,n,o)}return n[s].exports}for(var r=_t,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function l(t){return void 0===t}e.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},o.prototype.emit=function(t){var e,n,o,r,a,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(l(n=this._events[t]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(s(n))for(r=Array.prototype.slice.call(arguments,1),o=(c=n.slice()).length,a=0;a<o;a++)c[a].apply(this,r);return!0},o.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(n=l(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(t,e){if(!i(e))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(t,o),n||(n=!0,e.apply(this,arguments))}return o.listener=e,this.on(t,o),this},o.prototype.removeListener=function(t,e){var n,o,r,l;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=(n=this._events[t]).length,o=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(l=r;l-- >0;)if(n[l]===e||n[l].listener&&n[l].listener===e){o=l;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},o.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},o.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},o.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},o.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,n){var o,i,r,s,l;l=navigator.userAgent.toLowerCase(),s=navigator.platform.toLowerCase(),r="ie"===(o=l.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&document.documentMode,(i={name:"version"===o[1]?o[3]:o[1],version:r||parseFloat("opera"===o[1]&&o[4]?o[4]:o[2]),platform:{name:l.match(/ip(?:ad|od|hone)/)?"ios":(l.match(/(?:webos|android)/)||s.match(/mac|win|linux/)||["other"])[0]}})[i.name]=!0,i[i.name+parseInt(i.version,10)]=!0,i.platform[i.platform.name]=!0,e.exports=i},{}],3:[function(t,e,n){var o,i,r,s=function(t,e){for(var n in e)l.call(e,n)&&(t[n]=e[n]);function o(){this.constructor=t}return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},l={}.hasOwnProperty,a=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},c=[].slice;o=t("events").EventEmitter,r=t("./browser.coffee"),i=function(t){var e,n;function o(t){var n,o,i;for(o in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),e)i=e[o],null==(n=this.options)[o]&&(n[o]=i)}return s(o,t),e={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},n={delay:500,copy:!1},o.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},o.prototype.setOptions=function(t){var e,n,o;for(e in n=[],t)l.call(t,e)&&(o=t[e],n.push(this.setOption(e,o)));return n},o.prototype.addFrame=function(t,e){var o,i;for(i in null==e&&(e={}),(o={}).transparent=this.options.transparent,n)o[i]=e[i]||n[i];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!=typeof ImageData&&null!==ImageData&&t instanceof ImageData)o.data=t.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?o.data=this.getContextData(t):o.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?o.data=this.getImageData(t):o.image=t}return this.frames.push(o)},o.prototype.render=function(){var t,e,n;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,n;for(n=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)n.push(null);return n}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,n=e;0<=n?t<n:t>n;0<=n?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},o.prototype.abort=function(){for(var t;null!=(t=this.activeWorkers.shift());)this.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},o.prototype.spawnWorkers=function(){var t,e,n,o;return t=Math.min(this.options.workers,this.frames.length),function(){n=[];for(var o=e=this.freeWorkers.length;e<=t?o<t:o>t;e<=t?o++:o--)n.push(o);return n}.apply(this).forEach((o=this,function(t){var e;return o.log("spawning worker "+t),(e=new Worker(o.options.workerScript)).onmessage=function(t){return o.activeWorkers.splice(o.activeWorkers.indexOf(e),1),o.freeWorkers.push(e),o.frameFinished(t.data)},o.freeWorkers.push(e)})),t},o.prototype.frameFinished=function(t){var e,n;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,!0===this.options.globalPalette&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(e=1,n=this.freeWorkers.length;1<=n?e<n:e>n;1<=n?++e:--e)this.renderNextFrame();return a.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},o.prototype.finishRendering=function(){var t,e,n,o,i,r,s,l,a,c,u,d,h,p,f,m;for(l=0,i=0,a=(p=this.imageParts).length;i<a;i++)l+=((e=p[i]).data.length-1)*e.pageSize+e.cursor;for(l+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(l/1e3)+"kb"),t=new Uint8Array(l),d=0,r=0,c=(f=this.imageParts).length;r<c;r++)for(n=s=0,u=(m=(e=f[r]).data).length;s<u;n=++s)h=m[n],t.set(h,d),n===e.data.length-1?d+=e.cursor:d+=e.pageSize;return o=new Blob([t],{type:"image/gif"}),this.emit("finished",o,t)},o.prototype.renderNextFrame=function(){var t,e,n;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],n=this.freeWorkers.shift(),e=this.getTask(t),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(e)},o.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},o.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(e=this._canvas.getContext("2d")).setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},o.prototype.getTask=function(t){var e,n;if(n={index:e=this.frames.indexOf(t),last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===r.name},null!=t.data)n.data=t.data;else if(null!=t.context)n.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");n.data=this.getImageData(t.image)}return n},o.prototype.log=function(){var t;if(t=1<=arguments.length?c.call(arguments,0):[],this.options.debug)return console.log.apply(console,t)},o}(o),e.exports=i},{"./browser.coffee":2,events:1}]},{},[3])(3)}(wt={exports:{}},wt.exports),wt.exports);function $t(t){let e;return{c(){e=y("i"),e.textContent="pause",b(e,"class","material-icons")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function kt(t){let e;return{c(){e=y("i"),e.textContent="play_arrow",b(e,"class","material-icons")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function It(t){let e,n,o,r,s,l,a,c,u,d,h,p,f,k,I,C,E,L,R,S,O,P,T,D,j,F,N,A=t[0]+1+"";function W(t,e){return t[1]?$t:kt}let M=W(t),z=M(t);return P=new ft({props:{id:"goback",onClick:t[2],buttonText:"Back"}}),D=new ft({props:{id:"generate",onClick:t[10],buttonText:"Generate"}}),{c(){e=y("div"),n=y("div"),n.innerHTML='<h2 class="mdl-card__title-text">3. Generate</h2>',o=_(),r=y("span"),s=y("canvas"),l=_(),a=y("div"),c=y("button"),c.innerHTML='<i class="material-icons">remove</i>',u=_(),d=y("span"),h=y("span"),p=x("Frame "),f=x(A),k=_(),I=y("button"),z.c(),C=_(),E=y("button"),E.innerHTML='<i class="material-icons">add</i>',L=_(),R=y("div"),R.textContent="INSTRUCTIONS HERE",S=_(),O=y("div"),et(P.$$.fragment),T=_(),et(D.$$.fragment),b(n,"class","mdl-card__title svelte-11wlo1z"),b(s,"id","gifCanvas"),b(s,"class","gif-canvas svelte-11wlo1z"),b(s,"width","128"),b(s,"height","128"),b(r,"class","gif-canvas-container svelte-11wlo1z"),b(c,"class","mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--2mini-fab svelte-11wlo1z"),b(h,"class","mdl-chip__text"),b(I,"type","button"),b(I,"class","mdl-chip__action"),b(d,"class","mdl-chip mdl-chip--deletable"),b(E,"class","mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--2mini-fab svelte-11wlo1z"),b(a,"class","frame-count-container svelte-11wlo1z"),b(R,"class","mdl-card__supporting-text"),b(O,"class","mdl-card__actions mdl-card--border"),b(e,"class","customize-canvas-container mdl-card mdl-shadow--2dp svelte-11wlo1z")},m(i,v){g(i,e,v),m(e,n),m(e,o),m(e,r),m(r,s),m(e,l),m(e,a),m(a,c),m(a,u),m(a,d),m(d,h),m(h,p),m(h,f),m(d,k),m(d,I),z.m(I,null),m(a,C),m(a,E),m(e,L),m(e,R),m(e,S),m(e,O),nt(P,O,null),m(O,T),nt(D,O,null),j=!0,F||(N=[w(s,"scroll",t[3]),w(s,"mousedown",t[6]),w(s,"mousemove",t[9]),w(s,"mouseup",t[7]),w(s,"mouseout",t[8]),w(c,"click",t[14]),w(I,"click",t[5]),w(E,"click",t[15])],F=!0)},p(t,e){(!j||1&e[0])&&A!==(A=t[0]+1+"")&&$(f,A),M!==(M=W(t))&&(z.d(1),z=M(t),z&&(z.c(),z.m(I,null)))},i(t){j||(J(P.$$.fragment,t),J(D.$$.fragment,t),j=!0)},o(t){K(P.$$.fragment,t),K(D.$$.fragment,t),j=!1},d(t){t&&v(e),z.d(),ot(P),ot(D),F=!1,i(N)}}}function Ct(t,e,n){let o=0,{croppedImage:i}=e,{step:r}=e;let s,l,a,c,u,d,h,p,f,m,g,{imageSelection:v="partyParrot"}=e,y=36,x=25,_="partyParrot",w=[],b=!1,$={x:0,y:0};function k(){u=l.getBoundingClientRect(),d=u.left,h=u.top}function I(t=_){const e=[];let n=0;const o=dt[t].positions.length;return console.log(t,o),y=o,new Promise(((i,r)=>{for(var s=0;s<o;s++)e[s]=new Image,e[s].src=`${t}/${s}.gif`,e[s].onload=()=>{n++,n===o&&i(e)}}))}function C(t){a.clearRect(0,0,1e3,1e3),console.log(w),n(0,o=t),console.log(o,c.length),o>c.length-1&&n(0,o=0),o<0&&n(0,o=c.length-1),c.length==y&&R(o)}function E(t,e){const n=e??a;return c[t]&&(console.log("drawing parrot",c[t]),n.drawImage(c[t],0,0)),n.restore(),t}function L(t,e){if(s){const n=e??a,o=s.width/4,i=s.height/4,r=w[t]?.x?w[t].x:0,l=w[t]?.y?w[t].y:0;console.log(o,i),console.log(w,t),n.drawImage(s,r,l,s.width,s.height)}}function R(t=o){a.clearRect(0,0,l.width,l.height),E(t),L(t)}O((()=>{l=document.getElementById("gifCanvas"),a=l.getContext("2d"),k(),document.addEventListener("scroll",k),window.addEventListener("resize",k),I().then((t=>{c=t,w=[...dt[v].positions],x=dt[v].playSpeed,C(0)}))})),function(t){S().$$.after_update.push(t)}((()=>{console.log(v),s===i&&v===_||(console.log(v,_),s=i,I(v).then((t=>{console.log(t),_=v,w=[...dt[v].positions],x=dt[v].playSpeed,c=t,C(0)})))}));return t.$$set=t=>{"croppedImage"in t&&n(12,i=t.croppedImage),"step"in t&&n(11,r=t.step),"imageSelection"in t&&n(13,v=t.imageSelection)},[o,g,()=>{n(11,r=1)},t=>k(),C,function(){g?(g&&clearInterval(g),n(1,g=void 0)):g||n(1,g=setInterval((()=>{C(o+1)}),x))},function(t){const e=w[o]?.x?w[o].x:0,n=w[o]?.y?w[o].y:0;0===t.button&&p>e&&f>n&&p<e+s.width&&f<n+s.height&&(m={x:p,y:f},$={x:e,y:n},console.log("orig pos",m),b=!0)},function(t){p=parseInt(t.clientX-d),f=parseInt(t.clientY-h),b=!1},function(t){p=parseInt(t.clientX-d),f=parseInt(t.clientY-h),b=!1},function(t){p=parseInt(t.clientX-d),f=parseInt(t.clientY-h),b&&(console.log(p,f),w[o]={x:$.x-(m.x-p),y:$.y-(m.y-f)},R())},function(){const t=new bt({workers:2,quality:8,transparent:0,width:128,height:128});console.log("POSITIONS ARR",w);const e=document.createElement("canvas");e.width=128,e.height=128;const n=e.getContext("2d");console.log("image arr",c),c.forEach(((o,i)=>{n.clearRect(0,0,e.width,e.height),console.log("frameCount",i),E(i,n),L(i,n),t.addFrame(n,{copy:!0,delay:x}),console.log(o,i)})),t.on("finished",(function(t){console.log(t),window.open(URL.createObjectURL(t))})),t.render(),console.log("test here")},r,i,v,()=>C(o-1),()=>C(o+1)]}class Et extends st{constructor(t){super(),rt(this,t,Ct,It,s,{croppedImage:12,step:11,imageSelection:13},[-1,-1])}}function Lt(t){const e=t-1;return e*e*e+1}function Rt(t,{delay:e=0,duration:n=400,easing:o=Lt,start:i=0,opacity:r=0}={}){const s=getComputedStyle(t),l=+s.opacity,a="none"===s.transform?"":s.transform,c=1-i,u=l*(1-r);return{delay:e,duration:n,easing:o,css:(t,e)=>`\n\t\t\ttransform: ${a} scale(${1-c*e});\n\t\t\topacity: ${l-u*e}\n\t\t`}}function St(t){let e,n,o,i,r,s,l,a,c,u,d,h,p;function f(e){t[5](e)}function m(e){t[6](e)}let x={};function w(e){t[7](e)}void 0!==t[0]&&(x.step=t[0]),void 0!==t[2]&&(x.selectedOption=t[2]),n=new xt({props:x}),T.push((()=>tt(n,"step",f))),T.push((()=>tt(n,"selectedOption",m)));let $={croppedImage:t[1],imageSelection:t[2]};return void 0!==t[0]&&($.step=t[0]),c=new Et({props:$}),T.push((()=>tt(c,"step",w))),{c(){e=y("div"),et(n.$$.fragment),l=_(),a=y("div"),et(c.$$.fragment),b(e,"class","mdl-cell mdl-cell--6-col mdl-cell--12-col-tablet mdl-cell--12-col-phone"),b(a,"class","mdl-cell mdl-cell--6-col mdl-cell--12-col-tablet mdl-cell--12-col-phone")},m(t,o){g(t,e,o),nt(n,e,null),g(t,l,o),g(t,a,o),nt(c,a,null),p=!0},p(t,e){const r={};!o&&1&e&&(o=!0,r.step=t[0],W((()=>o=!1))),!i&&4&e&&(i=!0,r.selectedOption=t[2],W((()=>i=!1))),n.$set(r);const s={};2&e&&(s.croppedImage=t[1]),4&e&&(s.imageSelection=t[2]),!u&&1&e&&(u=!0,s.step=t[0],W((()=>u=!1))),c.$set(s)},i(t){p||(J(n.$$.fragment,t),A((()=>{s&&s.end(1),r||(r=V(e,Rt,{duration:500,delay:500})),r.start()})),J(c.$$.fragment,t),A((()=>{h&&h.end(1),d||(d=V(a,Rt,{duration:500,delay:500})),d.start()})),p=!0)},o(t){K(n.$$.fragment,t),r&&r.invalidate(),s=Z(e,Rt,{duration:500}),K(c.$$.fragment,t),d&&d.invalidate(),h=Z(a,Rt,{duration:500}),p=!1},d(t){t&&v(e),ot(n),t&&s&&s.end(),t&&v(l),t&&v(a),ot(c),t&&h&&h.end()}}}function Ot(t){let e,n,o,i,r,s,l;function a(e){t[3](e)}function c(e){t[4](e)}let u={};return void 0!==t[0]&&(u.step=t[0]),void 0!==t[1]&&(u.croppedImage=t[1]),n=new ut({props:u}),T.push((()=>tt(n,"step",a))),T.push((()=>tt(n,"croppedImage",c))),{c(){e=y("div"),et(n.$$.fragment),b(e,"class","mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-cell--12-col-phone")},m(t,o){g(t,e,o),nt(n,e,null),l=!0},p(t,e){const r={};!o&&1&e&&(o=!0,r.step=t[0],W((()=>o=!1))),!i&&2&e&&(i=!0,r.croppedImage=t[1],W((()=>i=!1))),n.$set(r)},i(t){l||(J(n.$$.fragment,t),A((()=>{s&&s.end(1),r||(r=V(e,Rt,{duration:500,delay:500})),r.start()})),l=!0)},o(t){K(n.$$.fragment,t),r&&r.invalidate(),s=Z(e,Rt,{duration:500}),l=!1},d(t){t&&v(e),ot(n),t&&s&&s.end()}}}function Pt(t){let e,n,o,r,s,l,a,c,u;const d=[Ot,St],h=[];function p(t,e){return 1===t[0]?0:2===t[0]?1:-1}return~(a=p(t))&&(c=h[a]=d[a](t)),{c(){e=y("main"),n=y("div"),o=y("h1"),o.textContent="Face GIF",r=_(),s=y("div"),l=y("div"),c&&c.c(),b(o,"class","svelte-ktp9cw"),b(l,"class","mdl-grid"),b(s,"class","main-content svelte-ktp9cw"),b(n,"id","app"),b(e,"class","container")},m(t,i){g(t,e,i),m(e,n),m(n,o),m(n,r),m(n,s),m(s,l),~a&&h[a].m(l,null),u=!0},p(t,[e]){let n=a;a=p(t),a===n?~a&&h[a].p(t,e):(c&&(H={r:0,c:[],p:H},K(h[n],1,1,(()=>{h[n]=null})),H.r||i(H.c),H=H.p),~a?(c=h[a],c?c.p(t,e):(c=h[a]=d[a](t),c.c()),J(c,1),c.m(l,null)):c=null)},i(t){u||(J(c),u=!0)},o(t){K(c),u=!1},d(t){t&&v(e),~a&&h[a].d()}}}function Tt(t,e,n){let o,i,r=1;return[r,o,i,function(t){r=t,n(0,r)},function(t){o=t,n(1,o)},function(t){r=t,n(0,r)},function(t){i=t,n(2,i)},function(t){r=t,n(0,r)}]}return new class extends st{constructor(t){super(),rt(this,t,Tt,Pt,s,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
